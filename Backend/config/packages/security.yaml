security:
    # ğŸ” Configuration du hachage de mot de passe pour les utilisateurs
    password_hashers:
        Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface: 'auto'

    # ğŸ‘¥ Fournisseur d'utilisateurs : ici on utilise l'entitÃ© Gerant
    providers:
        app_user_provider:
            entity:
                class: App\Entity\Gerant
                property: emailGerant  # ğŸ“§ C'est avec ce champ que les gÃ©rants vont se connecter

    # ğŸ”¥ DÃ©finition des diffÃ©rents firewalls (zones de sÃ©curitÃ©)
    firewalls:
        # ğŸ”§ Firewall pour la partie dÃ©veloppement (profiler, debug toolbar, assets)
        dev:
            pattern: ^/(_(profiler|wdt)|css|images|js)/
            security: false  # âš ï¸ Pas de sÃ©curitÃ© sur ces routes

        # ğŸ” Firewall pour les routes API (React communique ici)
        api:
            pattern: ^/api/  # ğŸ¯ Cible toutes les routes commenÃ§ant par /api/
            stateless: true  # ğŸš« Pas de session pour l'API (important pour Ã©viter l'erreur "session used while stateless")
            # ğŸ”“ Pour le moment, ouvert Ã  tous via access_control (voir plus bas)

        # ğŸ” Firewall pour la partie admin / gÃ©rants
        main:
            lazy: true
            provider: app_user_provider  # Utilise les gÃ©rants comme utilisateurs
            custom_authenticator: App\Security\GerantAuthenticator  # Authentification personnalisÃ©e
            logout:
                path: app_logout  # ğŸšª Route de dÃ©connexion
                target: app_login  # ğŸ¯ Redirection aprÃ¨s dÃ©connexion (vers la page de login)

            # PossibilitÃ© d'ajouter d'autres moyens d'authentification ici (ex: form_login, JWT...)

    # ğŸ›¡ï¸ RÃ¨gles d'accÃ¨s : qui a le droit de faire quoi ?
    access_control:
        - { path: ^/api, roles: PUBLIC_ACCESS }  # âœ… Toutes les routes API accessibles sans Ãªtre connectÃ© (inscription, affichage public)
        - { path: ^/admin, roles: ROLE_ADMIN }  # ğŸ” AccÃ¨s Ã  /admin rÃ©servÃ© aux admins (gÃ©rants)
        # Tu peux ajouter d'autres rÃ¨gles ici (ex: - { path: ^/profile, roles: ROLE_USER })

# âš™ï¸ Optimisation du hashage des mots de passe en mode test (rapide pour les tests)
when@test:
    security:
        password_hashers:
            Symfony\Component\Security\Core\User\PasswordAuthenticatedUserInterface:
                algorithm: auto
                cost: 4  # âš¡ï¸ Plus rapide en mode test (Bcrypt)
                time_cost: 3  # âš¡ï¸ Argon : plus rapide pour les tests
                memory_cost: 10  # âš¡ï¸ Argon : consomme peu de mÃ©moire pour les tests
